<!DOCTYPE html>
<!-- saved from url=(0163)file:///D:/DESKTOP/%E5%AD%A6%E6%9C%AF/%E7%A0%94%E7%A9%B6/%E3%80%90code%E3%80%91/%E7%AD%9B%E9%80%89%E4%B8%8D%E6%87%82%E7%9A%84%E5%8D%95%E8%AF%8D/cet6-listening.html -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CET-6 Âê¨ÂäõÁªÉ‰π†Â∫îÁî®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header-info {
            font-size: 16px;
            opacity: 0.9;
        }

        .main-content {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .exercise-title {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .context-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 4px solid #2196f3;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .context-box h3 {
            color: #1976d2;
            margin-bottom: 8px;
        }

        .audio-controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
        }

        .audio-main-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .play-button, .stop-button {
            background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .play-button:hover, .stop-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .stop-button {
            background: linear-gradient(135deg, #f44336 0%, #ef5350 100%);
        }

        .stop-button:hover {
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
        }

        .speed-control, .voice-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .speed-select, .voice-select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            background: white;
            cursor: pointer;
        }

        .voice-controls-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        .voice-control-group {
            background: #fff;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
        }

        .voice-control-group.female {
            border-color: #e91e63;
            background: linear-gradient(135deg, #fce4ec15 0%, #f8bbd915 100%);
        }

        .voice-control-group.male {
            border-color: #2196f3;
            background: linear-gradient(135deg, #e3f2fd15 0%, #bbdefb15 100%);
        }

        .voice-control-label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .voice-control-label.female {
            color: #c2185b;
        }

        .voice-control-label.male {
            color: #1976d2;
        }

        .voice-select-full {
            width: 100%;
            margin-top: 5px;
        }

        .progress-container {
            margin-top: 15px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            color: #666;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #2196f3 0%, #42a5f5 100%);
            width: 0%;
            transition: width 0.1s linear;
            border-radius: 4px;
        }

        .progress-indicator {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: rgba(33, 150, 243, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.3; }
            50% { opacity: 0.6; }
            100% { opacity: 0.3; }
        }

        .voice-debug {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 10px;
            margin-top: 10px;
            font-size: 12px;
            color: #856404;
        }

        .voice-test-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .test-voice-button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .test-female {
            background: linear-gradient(135deg, #e91e63 0%, #f06292 100%);
            color: white;
        }

        .test-male {
            background: linear-gradient(135deg, #2196f3 0%, #42a5f5 100%);
            color: white;
        }

        .test-voice-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .dialogue-toggle {
            background: linear-gradient(135deg, #2196f3 0%, #42a5f5 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .dialogue-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .questions-toggle {
            background: linear-gradient(135deg, #ff9800 0%, #ffa726 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .questions-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }

        .dialogue-section, .questions-section {
            background: #fafafa;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .dialogue-content {
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .dialogue-content::-webkit-scrollbar {
            width: 6px;
        }

        .dialogue-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .dialogue-content::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .dialogue-item {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .dialogue-item.woman {
            background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%);
            border-left: 4px solid #e91e63;
        }

        .dialogue-item.man {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 4px solid #2196f3;
        }

        .dialogue-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .speaker-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .speaker-avatar {
            font-size: 24px;
        }

        .play-line-button {
            margin-left: auto;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .play-line-button:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .dialogue-text {
            line-height: 1.8;
            font-size: 15px;
            color: #424242;
        }

        .word {
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 3px;
            transition: all 0.2s ease;
        }

        .word:hover {
            background: rgba(33, 150, 243, 0.1);
            color: #1976d2;
        }

        .word.mastered {
            background: rgba(76, 175, 80, 0.1);
            color: #2e7d32;
            border-bottom: 2px solid #4caf50;
        }

        .questions-content {
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .questions-content::-webkit-scrollbar {
            width: 6px;
        }

        .questions-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .questions-content::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .question-item {
            margin-bottom: 30px;
        }

        .question-number {
            background: linear-gradient(135deg, #ff9800 0%, #ffa726 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 10px;
            display: inline-block;
        }

        .question-text {
            font-size: 16px;
            line-height: 1.6;
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #6c757d;
        }

        .option-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 12px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
        }

        .option-item:hover {
            border-color: #2196f3;
            background: #f3f8ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.15);
        }

        .option-item.selected {
            border-color: #2196f3;
            background: #e3f2fd;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.2);
        }

        .option-item.correct {
            border-color: #4caf50;
            background: #e8f5e8;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
        }

        .option-item.wrong {
            border-color: #f44336;
            background: #ffebee;
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.2);
        }

        .option-letter {
            width: 32px;
            height: 32px;
            background: #6c757d;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .option-item.correct .option-letter {
            background: #4caf50;
        }

        .option-item.wrong .option-letter {
            background: #f44336;
        }

        .option-text {
            flex: 1;
            font-size: 15px;
            line-height: 1.5;
            color: #424242;
        }

        .submit-section {
            border-top: 2px solid #e9ecef;
            padding-top: 20px;
            text-align: center;
        }

        .progress-text {
            margin-bottom: 15px;
            color: #666;
            font-weight: 500;
        }

        .submit-button {
            background: linear-gradient(135deg, #2196f3 0%, #42a5f5 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
        }

        .submit-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .submit-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .results-section {
            border-top: 2px solid #e9ecef;
            padding-top: 20px;
            text-align: center;
        }

        .score-display {
            margin-bottom: 20px;
        }

        .score-text {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .score-grade {
            margin-left: 15px;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .score-grade.pass {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .score-grade.fail {
            background: #ffebee;
            color: #c62828;
        }

        .reset-button {
            background: linear-gradient(135deg, #ff9800 0%, #ffa726 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
        }

        .reset-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        .answer-explanation {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-left: 4px solid #ff9800;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .explanation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .explanation-header h4 {
            margin: 0;
            color: #e65100;
            font-size: 16px;
        }

        .correct-answer {
            background: #ff9800;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 12px;
        }

        .explanation-text {
            color: #5d4037;
            line-height: 1.6;
            font-size: 14px;
            font-style: italic;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .content-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .voice-controls-container {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .header h1 {
                font-size: 24px;
            }

            .main-content {
                padding: 20px;
            }

            .audio-main-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .play-button, .stop-button {
                width: 100%;
                justify-content: center;
            }

            .speed-control {
                justify-content: center;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üéß CET-6 Âê¨ÂäõÁªÉ‰π†</h1>
            <div class="header-info">
                <span>Ëã±ËØ≠ÂÖ≠Á∫ß</span> | <span>Âê¨ÂäõÁêÜËß£</span>
            </div>
        </header>

        <div class="main-content">
            <div class="exercise-title">Crisis Management</div>

            <div class="context-box">
                <h3>ËÉåÊôØ‰ø°ÊÅØ</h3>
                <p>Two campaign strategists, Mark and Sarah, are discussing a serious incident involving their candidate running for Mayor just weeks before the election.</p>
            </div>

            <div class="audio-controls">
                <div class="audio-main-controls">
                    <button class="play-button" id="playButton" onclick="playDialogue()" style="display: inline-block;">‚ñ∂Ô∏è Êí≠ÊîæÂØπËØù</button>
                    <button class="stop-button" id="stopButton" onclick="stopDialogue()" style="display: none;">‚èπÔ∏è ÂÅúÊ≠¢Êí≠Êîæ</button>

                    <div class="speed-control">
                        <label>Êí≠ÊîæÈÄüÂ∫¶:</label>
                        <select class="speed-select" id="speedSelect">
                            <option value="0.5">0.5x</option>
                            <option value="0.75">0.75x</option>
                            <option value="1" selected="">1x</option>
                            <option value="1.25">1.25x</option>
                            <option value="1.5">1.5x</option>
                        </select>
                    </div>
                </div>

                <div class="voice-controls-container">
                    <div class="voice-control-group female">
                        <div class="voice-control-label female">
                            <span>üë©</span>
                            <span>Â•≥Â£∞ÈÄâÊã©</span>
                        </div>
                        <select class="voice-select voice-select-full" id="femaleVoiceSelect"><option value="auto">Ëá™Âä®ÈÄâÊã©</option><optgroup label="Â•≥Â£∞"><option value="female-81">Microsoft Natasha Online (Natural) - English (Australia) (en-AU)</option><option value="female-84">Microsoft Yan Online (Natural) - English (Hong Kong SAR) (en-HK)</option><option value="female-87">Microsoft Neerja Online (Natural) - English (India) (en-IN)</option><option value="female-90">Microsoft Emily Online (Natural) - English (Ireland) (en-IE)</option><option value="female-93">Microsoft Mitchell Online (Natural) - English (New Zealand) (en-NZ)</option><option value="female-96">Microsoft Ezinne Online (Natural) - English (Nigeria) (en-NG)</option><option value="female-99">Microsoft Ava Online (Natural) - English (United States) (en-US)</option><option value="female-102">Microsoft Brian Online (Natural) - English (United States) (en-US)</option><option value="female-105">Microsoft Leah Online (Natural) - English (South Africa) (en-ZA)</option><option value="female-111">Microsoft Ryan Online (Natural) - English (United Kingdom) (en-GB)</option><option value="female-114">Microsoft Ana Online (Natural) - English (United States) (en-US)</option><option value="female-117">Microsoft AvaMultilingual Online (Natural) - English (United States) (en-US)</option><option value="female-120">Microsoft EmmaMultilingual Online (Natural) - English (United States) (en-US)</option><option value="female-123">Microsoft Jenny Online (Natural) - English (United States) (en-US)</option><option value="female-126">Microsoft Steffan Online (Natural) - English (United States) (en-US)</option><option value="female-246">Microsoft Marcelo Online (Natural) - Spanish (Bolivia) (es-BO)</option><option value="female-247">Microsoft Sofia Online (Natural) - Spanish (Bolivia) (es-BO)</option></optgroup></select>
                        <div class="voice-test-buttons">
                            <button class="test-voice-button test-female" onclick="testFemaleVoice()">ÊµãËØïÂ•≥Â£∞</button>
                        </div>
                    </div>

                    <div class="voice-control-group male">
                        <div class="voice-control-label male">
                            <span>üë®</span>
                            <span>Áî∑Â£∞ÈÄâÊã©</span>
                        </div>
                        <select class="voice-select voice-select-full" id="maleVoiceSelect"><option value="auto">Ëá™Âä®ÈÄâÊã©</option><optgroup label="Áî∑Â£∞"><option value="male-23">Microsoft Iman Online (Natural) - Arabic (Libya) (ar-LY)</option><option value="male-27">Microsoft Abdullah Online (Natural) - Arabic (Oman) (ar-OM)</option><option value="male-28">Microsoft Aysha Online (Natural) - Arabic (Oman) (ar-OM)</option><option value="male-33">Microsoft Amany Online (Natural) - Arabic (Syria) (ar-SY)</option><option value="male-64">Microsoft Xiaobei Online (Natural) - Chinese (Northeastern Mandarin) (zh-CN-liaoning)</option><option value="male-67">Microsoft HsiaoYu Online (Natural) - Chinese (Taiwanese Mandarin) (zh-TW)</option><option value="male-68">Microsoft Xiaoni Online (Natural) - Chinese (Zhongyuan Mandarin Shaanxi) (zh-CN-shaanxi)</option><option value="male-73">Microsoft Christel Online (Natural) - Danish (Denmark) (da-DK)</option><option value="male-74">Microsoft Jeppe Online (Natural) - Danish (Denmark) (da-DK)</option><option value="male-80">Microsoft WilliamMultilingual Online (Natural) - English (Australia) (en-AU)</option><option value="male-82">Microsoft Clara Online (Natural) - English (Canada) (en-CA)</option><option value="male-83">Microsoft Liam Online (Natural) - English (Canada) (en-CA)</option><option value="male-85">Microsoft Sam Online (Natural) - English (Hongkong) (en-HK)</option><option value="male-86">Microsoft Neerja Online (Natural) - English (India) (Preview) (en-IN)</option><option value="male-88">Microsoft Prabhat Online (Natural) - English (India) (en-IN)</option><option value="male-89">Microsoft Connor Online (Natural) - English (Ireland) (en-IE)</option><option value="male-91">Microsoft Asilia Online (Natural) - English (Kenya) (en-KE)</option><option value="male-92">Microsoft Chilemba Online (Natural) - English (Kenya) (en-KE)</option><option value="male-94">Microsoft Molly Online (Natural) - English (New Zealand) (en-NZ)</option><option value="male-95">Microsoft Abeo Online (Natural) - English (Nigeria) (en-NG)</option><option value="male-97">Microsoft James Online (Natural) - English (Philippines) (en-PH)</option><option value="male-98">Microsoft Rosa Online (Natural) - English (Philippines) (en-PH)</option><option value="male-100">Microsoft Andrew Online (Natural) - English (United States) (en-US)</option><option value="male-101">Microsoft Emma Online (Natural) - English (United States) (en-US)</option><option value="male-103">Microsoft Luna Online (Natural) - English (Singapore) (en-SG)</option><option value="male-104">Microsoft Wayne Online (Natural) - English (Singapore) (en-SG)</option><option value="male-106">Microsoft Luke Online (Natural) - English (South Africa) (en-ZA)</option><option value="male-107">Microsoft Elimu Online (Natural) - English (Tanzania) (en-TZ)</option><option value="male-108">Microsoft Imani Online (Natural) - English (Tanzania) (en-TZ)</option><option value="male-109">Microsoft Libby Online (Natural) - English (United Kingdom) (en-GB)</option><option value="male-110">Microsoft Maisie Online (Natural) - English (United Kingdom) (en-GB)</option><option value="male-112">Microsoft Sonia Online (Natural) - English (United Kingdom) (en-GB)</option><option value="male-113">Microsoft Thomas Online (Natural) - English (United Kingdom) (en-GB)</option><option value="male-115">Microsoft AndrewMultilingual Online (Natural) - English (United States) (en-US)</option><option value="male-116">Microsoft Aria Online (Natural) - English (United States) (en-US)</option><option value="male-118">Microsoft BrianMultilingual Online (Natural) - English (United States) (en-US)</option><option value="male-119">Microsoft Christopher Online (Natural) - English (United States) (en-US)</option><option value="male-121">Microsoft Eric Online (Natural) - English (United States) (en-US)</option><option value="male-122">Microsoft Guy Online (Natural) - English (United States) (en-US)</option><option value="male-124">Microsoft Michelle Online (Natural) - English (United States) (en-US)</option><option value="male-125">Microsoft Roger Online (Natural) - English (United States) (en-US)</option><option value="male-150">Microsoft Ingrid Online (Natural) - German (Austria) (de-AT)</option><option value="male-151">Microsoft Jonas Online (Natural) - German (Austria) (de-AT)</option><option value="male-152">Microsoft SeraphinaMultilingual Online (Natural) - German (Germany) (de-DE)</option><option value="male-153">Microsoft FlorianMultilingual Online (Natural) - German (Germany) (de-DE)</option><option value="male-154">Microsoft Amala Online (Natural) - German (Germany) (de-DE)</option><option value="male-155">Microsoft Conrad Online (Natural) - German (Germany) (de-DE)</option><option value="male-156">Microsoft Katja Online (Natural) - German (Germany) (de-DE)</option><option value="male-157">Microsoft Killian Online (Natural) - German (Germany) (de-DE)</option><option value="male-158">Microsoft Jan Online (Natural) - German (Switzerland) (de-CH)</option><option value="male-159">Microsoft Leni Online (Natural) - German (Switzerland) (de-CH)</option><option value="male-198">Microsoft Keomany Online (Natural) - Lao (Laos) (lo-LA)</option><option value="male-205">Microsoft Osman Online (Natural) - Malay (Malaysia) (ms-MY)</option><option value="male-212">Microsoft Manohar Online (Natural) - Marathi (India) (mr-IN)</option><option value="male-230">Microsoft Alina Online (Natural) - Romanian (Romania) (ro-RO)</option><option value="male-231">Microsoft Emil Online (Natural) - Romanian (Romania) (ro-RO)</option><option value="male-256">Microsoft Manuel Online (Natural) - Spanish (Cuba) (es-CU)</option><option value="male-314">Microsoft Salman Online (Natural) - Urdu (India) (ur-IN)</option></optgroup></select>
                        <div class="voice-test-buttons">
                            <button class="test-voice-button test-male" onclick="testMaleVoice()">ÊµãËØïÁî∑Â£∞</button>
                        </div>
                    </div>
                </div>

                <div class="progress-container">
                    <div class="progress-info">
                        <span id="currentTime">0:00</span>
                        <span id="totalTime">0:00</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                        <div class="progress-indicator" id="progressIndicator" style="width: 0%;"></div>
                    </div>
                </div>

                <div class="voice-debug" id="voiceDebug" style="display: block;">
                    <strong>ËØ≠Èü≥Ë∞ÉËØï‰ø°ÊÅØ:</strong>
                    <div id="debugInfo">
                ÊÄªËØ≠Èü≥Êï∞Èáè: 325<br>
                ÂèØÁî®Â•≥Â£∞: 17<br>
                ÂèØÁî®Áî∑Â£∞: 58<br>
                ÂΩìÂâçÂ•≥Â£∞ÈÄâÊã©: female-81<br>
                ÂΩìÂâçÁî∑Â£∞ÈÄâÊã©: male-115<br>
                ÊµèËßàÂô®: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0<br>
                ËØ≠Ë®ÄÊîØÊåÅ: 325 ËØ≠Èü≥
            </div>
                </div>
            </div>

            <div class="content-grid">
                <div class="dialogue-section">
                    <button class="dialogue-toggle" onclick="toggleDialogue()">
                        <span id="dialogueToggleText">üëÅÔ∏è ÈöêËóèÂØπËØùÂÜÖÂÆπ</span>
                    </button>

                    <h3 class="section-title">ÂØπËØùÂÜÖÂÆπ üí¨</h3>

                    <div class="dialogue-content" id="dialogueContent" style="display: none;">
                        <!-- ÂØπËØùÂÜÖÂÆπ‰øùÊåÅ‰∏çÂèò -->
                        <div class="dialogue-item woman">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë©</span>
                                <span>Â•≥Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;Mark, we have a disaster downstairs. The domestic staff is threatening to go on strike. Our candidate, Mr. Henderson, just had a meltdown.&#39;, &#39;woman&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">Mark</span>,
                                <span class="word" onclick="toggleWord(this)">we</span>
                                <span class="word" onclick="toggleWord(this)">have</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">disaster</span>
                                <span class="word mastered" onclick="toggleWord(this)">downstairs</span>.
                                <span class="word" onclick="toggleWord(this)">The</span>
                                <span class="word mastered" onclick="toggleWord(this)">domestic</span>
                                <span class="word" onclick="toggleWord(this)">staff</span>
                                <span class="word" onclick="toggleWord(this)">is</span>
                                <span class="word" onclick="toggleWord(this)">threatening</span>
                                <span class="word" onclick="toggleWord(this)">to</span>
                                <span class="word" onclick="toggleWord(this)">go</span>
                                <span class="word" onclick="toggleWord(this)">on</span>
                                <span class="word" onclick="toggleWord(this)">strike</span>.
                                <span class="word" onclick="toggleWord(this)">Our</span>
                                <span class="word mastered" onclick="toggleWord(this)">candidate</span>,
                                <span class="word" onclick="toggleWord(this)">Mr</span>.
                                <span class="word" onclick="toggleWord(this)">Henderson</span>,
                                <span class="word" onclick="toggleWord(this)">just</span>
                                <span class="word" onclick="toggleWord(this)">had</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">meltdown</span>.
                            </div>
                        </div>

                        <div class="dialogue-item man">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë®</span>
                                <span>Áî∑Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;Again? I saw trash and broken furniture in the hallway. Did he really drag the heavy oak table across the room?&#39;, &#39;man&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">Again</span>?
                                <span class="word" onclick="toggleWord(this)">I</span>
                                <span class="word" onclick="toggleWord(this)">saw</span>
                                <span class="word mastered" onclick="toggleWord(this)">trash</span>
                                <span class="word" onclick="toggleWord(this)">and</span>
                                <span class="word mastered" onclick="toggleWord(this)">broken</span>
                                <span class="word mastered" onclick="toggleWord(this)">furniture</span>
                                <span class="word" onclick="toggleWord(this)">in</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">hallway</span>.
                                <span class="word" onclick="toggleWord(this)">Did</span>
                                <span class="word" onclick="toggleWord(this)">he</span>
                                <span class="word" onclick="toggleWord(this)">really</span>
                                <span class="word mastered" onclick="toggleWord(this)">drag</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">heavy</span>
                                <span class="word" onclick="toggleWord(this)">oak</span>
                                <span class="word" onclick="toggleWord(this)">table</span>
                                <span class="word" onclick="toggleWord(this)">across</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">room</span>?
                            </div>
                        </div>

                        <!-- ÁªßÁª≠Ê∑ªÂä†ÂÖ∂‰ªñÂØπËØùË°å -->
                        <div class="dialogue-item woman">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë©</span>
                                <span>Â•≥Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;Yes. He claimed the chef put a political trick in his soup. He threw a wet towel, and even his underwear, at the poor servant. It was incredibly offensive. He shouted that he is the lord of this manor, not a plain citizen.&#39;, &#39;woman&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">Yes</span>.
                                <span class="word" onclick="toggleWord(this)">He</span>
                                <span class="word" onclick="toggleWord(this)">claimed</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word mastered" onclick="toggleWord(this)">chef</span>
                                <span class="word" onclick="toggleWord(this)">put</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word mastered" onclick="toggleWord(this)">political</span>
                                <span class="word mastered" onclick="toggleWord(this)">trick</span>
                                <span class="word" onclick="toggleWord(this)">in</span>
                                <span class="word" onclick="toggleWord(this)">his</span>
                                <span class="word" onclick="toggleWord(this)">soup</span>.
                                <span class="word" onclick="toggleWord(this)">He</span>
                                <span class="word mastered" onclick="toggleWord(this)">threw</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">wet</span>
                                <span class="word mastered" onclick="toggleWord(this)">towel</span>,
                                <span class="word" onclick="toggleWord(this)">and</span>
                                <span class="word" onclick="toggleWord(this)">even</span>
                                <span class="word" onclick="toggleWord(this)">his</span>
                                <span class="word mastered" onclick="toggleWord(this)">underwear</span>,
                                <span class="word" onclick="toggleWord(this)">at</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">poor</span>
                                <span class="word mastered" onclick="toggleWord(this)">servant</span>.
                                <span class="word" onclick="toggleWord(this)">It</span>
                                <span class="word" onclick="toggleWord(this)">was</span>
                                <span class="word mastered" onclick="toggleWord(this)">incredibly</span>
                                <span class="word mastered" onclick="toggleWord(this)">offensive</span>.
                                <span class="word" onclick="toggleWord(this)">He</span>
                                <span class="word" onclick="toggleWord(this)">shouted</span>
                                <span class="word" onclick="toggleWord(this)">that</span>
                                <span class="word" onclick="toggleWord(this)">he</span>
                                <span class="word" onclick="toggleWord(this)">is</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word mastered" onclick="toggleWord(this)">lord</span>
                                <span class="word" onclick="toggleWord(this)">of</span>
                                <span class="word" onclick="toggleWord(this)">this</span>
                                <span class="word" onclick="toggleWord(this)">manor</span>,
                                <span class="word" onclick="toggleWord(this)">not</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word mastered" onclick="toggleWord(this)">plain</span>
                                <span class="word" onclick="toggleWord(this)">citizen</span>.
                            </div>
                        </div>

                        <div class="dialogue-item man">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë®</span>
                                <span>Áî∑Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;That violates every criterion of civil behavior. If this external news reaches the Congress or the ethics panel, our capital in this contest will vanish. We can&#39;t pretend this is normal.&#39;, &#39;man&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">That</span>
                                <span class="word" onclick="toggleWord(this)">violates</span>
                                <span class="word" onclick="toggleWord(this)">every</span>
                                <span class="word" onclick="toggleWord(this)">criterion</span>
                                <span class="word" onclick="toggleWord(this)">of</span>
                                <span class="word" onclick="toggleWord(this)">civil</span>
                                <span class="word" onclick="toggleWord(this)">behavior</span>.
                                <span class="word" onclick="toggleWord(this)">If</span>
                                <span class="word" onclick="toggleWord(this)">this</span>
                                <span class="word" onclick="toggleWord(this)">external</span>
                                <span class="word" onclick="toggleWord(this)">news</span>
                                <span class="word" onclick="toggleWord(this)">reaches</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">Congress</span>
                                <span class="word" onclick="toggleWord(this)">or</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">ethics</span>
                                <span class="word" onclick="toggleWord(this)">panel</span>,
                                <span class="word" onclick="toggleWord(this)">our</span>
                                <span class="word" onclick="toggleWord(this)">capital</span>
                                <span class="word" onclick="toggleWord(this)">in</span>
                                <span class="word" onclick="toggleWord(this)">this</span>
                                <span class="word" onclick="toggleWord(this)">contest</span>
                                <span class="word" onclick="toggleWord(this)">will</span>
                                <span class="word" onclick="toggleWord(this)">vanish</span>.
                                <span class="word" onclick="toggleWord(this)">We</span>
                                <span class="word" onclick="toggleWord(this)">can't</span>
                                <span class="word" onclick="toggleWord(this)">pretend</span>
                                <span class="word" onclick="toggleWord(this)">this</span>
                                <span class="word" onclick="toggleWord(this)">is</span>
                                <span class="word" onclick="toggleWord(this)">normal</span>.
                            </div>
                        </div>

                        <div class="dialogue-item woman">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë©</span>
                                <span>Â•≥Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;I tried to whisper a warning to him, but he wouldn&#39;t lean in to listen. He has this notion that he can do whatever he wants. Honestly, he looks hollow. He&#39;s smoking pack after pack of cigarettes; I&#39;m worried about his lung capacity and organ failure.&#39;, &#39;woman&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">I</span>
                                <span class="word" onclick="toggleWord(this)">tried</span>
                                <span class="word" onclick="toggleWord(this)">to</span>
                                <span class="word" onclick="toggleWord(this)">whisper</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">warning</span>
                                <span class="word" onclick="toggleWord(this)">to</span>
                                <span class="word" onclick="toggleWord(this)">him</span>,
                                <span class="word" onclick="toggleWord(this)">but</span>
                                <span class="word" onclick="toggleWord(this)">he</span>
                                <span class="word" onclick="toggleWord(this)">wouldn't</span>
                                <span class="word" onclick="toggleWord(this)">lean</span>
                                <span class="word" onclick="toggleWord(this)">in</span>
                                <span class="word" onclick="toggleWord(this)">to</span>
                                <span class="word" onclick="toggleWord(this)">listen</span>.
                                <span class="word" onclick="toggleWord(this)">He</span>
                                <span class="word" onclick="toggleWord(this)">has</span>
                                <span class="word" onclick="toggleWord(this)">this</span>
                                <span class="word" onclick="toggleWord(this)">notion</span>
                                <span class="word" onclick="toggleWord(this)">that</span>
                                <span class="word" onclick="toggleWord(this)">he</span>
                                <span class="word" onclick="toggleWord(this)">can</span>
                                <span class="word" onclick="toggleWord(this)">do</span>
                                <span class="word" onclick="toggleWord(this)">whatever</span>
                                <span class="word" onclick="toggleWord(this)">he</span>
                                <span class="word" onclick="toggleWord(this)">wants</span>.
                                <span class="word" onclick="toggleWord(this)">Honestly</span>,
                                <span class="word" onclick="toggleWord(this)">he</span>
                                <span class="word" onclick="toggleWord(this)">looks</span>
                                <span class="word" onclick="toggleWord(this)">hollow</span>.
                                <span class="word" onclick="toggleWord(this)">He's</span>
                                <span class="word" onclick="toggleWord(this)">smoking</span>
                                <span class="word" onclick="toggleWord(this)">pack</span>
                                <span class="word" onclick="toggleWord(this)">after</span>
                                <span class="word" onclick="toggleWord(this)">pack</span>
                                <span class="word" onclick="toggleWord(this)">of</span>
                                <span class="word" onclick="toggleWord(this)">cigarettes</span>;
                                <span class="word" onclick="toggleWord(this)">I'm</span>
                                <span class="word" onclick="toggleWord(this)">worried</span>
                                <span class="word" onclick="toggleWord(this)">about</span>
                                <span class="word" onclick="toggleWord(this)">his</span>
                                <span class="word" onclick="toggleWord(this)">lung</span>
                                <span class="word" onclick="toggleWord(this)">capacity</span>
                                <span class="word" onclick="toggleWord(this)">and</span>
                                <span class="word" onclick="toggleWord(this)">organ</span>
                                <span class="word" onclick="toggleWord(this)">failure</span>.
                            </div>
                        </div>

                        <div class="dialogue-item man">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë®</span>
                                <span>Áî∑Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;We need insight into his mental state. Is he fit for the obligation of being mayor? Regardless, we must retain control. What is the amount needed to settle this?&#39;, &#39;man&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">We</span>
                                <span class="word" onclick="toggleWord(this)">need</span>
                                <span class="word" onclick="toggleWord(this)">insight</span>
                                <span class="word" onclick="toggleWord(this)">into</span>
                                <span class="word" onclick="toggleWord(this)">his</span>
                                <span class="word" onclick="toggleWord(this)">mental</span>
                                <span class="word" onclick="toggleWord(this)">state</span>.
                                <span class="word" onclick="toggleWord(this)">Is</span>
                                <span class="word" onclick="toggleWord(this)">he</span>
                                <span class="word" onclick="toggleWord(this)">fit</span>
                                <span class="word" onclick="toggleWord(this)">for</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">obligation</span>
                                <span class="word" onclick="toggleWord(this)">of</span>
                                <span class="word" onclick="toggleWord(this)">being</span>
                                <span class="word" onclick="toggleWord(this)">mayor</span>?
                                <span class="word" onclick="toggleWord(this)">Regardless</span>,
                                <span class="word" onclick="toggleWord(this)">we</span>
                                <span class="word" onclick="toggleWord(this)">must</span>
                                <span class="word" onclick="toggleWord(this)">retain</span>
                                <span class="word" onclick="toggleWord(this)">control</span>.
                                <span class="word" onclick="toggleWord(this)">What</span>
                                <span class="word" onclick="toggleWord(this)">is</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">amount</span>
                                <span class="word" onclick="toggleWord(this)">needed</span>
                                <span class="word" onclick="toggleWord(this)">to</span>
                                <span class="word" onclick="toggleWord(this)">settle</span>
                                <span class="word" onclick="toggleWord(this)">this</span>?
                            </div>
                        </div>

                        <div class="dialogue-item woman">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë©</span>
                                <span>Â•≥Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;The attorney sent a quotation. The staff demands a higher wage and a sincere apology, or they walk. It is a hefty sum.&#39;, &#39;woman&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">The</span>
                                <span class="word" onclick="toggleWord(this)">attorney</span>
                                <span class="word" onclick="toggleWord(this)">sent</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">quotation</span>.
                                <span class="word" onclick="toggleWord(this)">The</span>
                                <span class="word" onclick="toggleWord(this)">staff</span>
                                <span class="word" onclick="toggleWord(this)">demands</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">higher</span>
                                <span class="word" onclick="toggleWord(this)">wage</span>
                                <span class="word" onclick="toggleWord(this)">and</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">sincere</span>
                                <span class="word" onclick="toggleWord(this)">apology</span>,
                                <span class="word" onclick="toggleWord(this)">or</span>
                                <span class="word" onclick="toggleWord(this)">they</span>
                                <span class="word" onclick="toggleWord(this)">walk</span>.
                                <span class="word" onclick="toggleWord(this)">It</span>
                                <span class="word" onclick="toggleWord(this)">is</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">hefty</span>
                                <span class="word" onclick="toggleWord(this)">sum</span>.
                            </div>
                        </div>

                        <div class="dialogue-item man">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë®</span>
                                <span>Áî∑Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;We have to grant it. Our objective is to win. We can&#39;t let the motor of this campaign stall now. Is there any stuff we can use to spin this?&#39;, &#39;man&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">We</span>
                                <span class="word" onclick="toggleWord(this)">have</span>
                                <span class="word" onclick="toggleWord(this)">to</span>
                                <span class="word" onclick="toggleWord(this)">grant</span>
                                <span class="word" onclick="toggleWord(this)">it</span>.
                                <span class="word" onclick="toggleWord(this)">Our</span>
                                <span class="word" onclick="toggleWord(this)">objective</span>
                                <span class="word" onclick="toggleWord(this)">is</span>
                                <span class="word" onclick="toggleWord(this)">to</span>
                                <span class="word" onclick="toggleWord(this)">win</span>.
                                <span class="word" onclick="toggleWord(this)">We</span>
                                <span class="word" onclick="toggleWord(this)">can't</span>
                                <span class="word" onclick="toggleWord(this)">let</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">motor</span>
                                <span class="word" onclick="toggleWord(this)">of</span>
                                <span class="word" onclick="toggleWord(this)">this</span>
                                <span class="word" onclick="toggleWord(this)">campaign</span>
                                <span class="word" onclick="toggleWord(this)">stall</span>
                                <span class="word" onclick="toggleWord(this)">now</span>.
                                <span class="word" onclick="toggleWord(this)">Is</span>
                                <span class="word" onclick="toggleWord(this)">there</span>
                                <span class="word" onclick="toggleWord(this)">any</span>
                                <span class="word" onclick="toggleWord(this)">stuff</span>
                                <span class="word" onclick="toggleWord(this)">we</span>
                                <span class="word" onclick="toggleWord(this)">can</span>
                                <span class="word" onclick="toggleWord(this)">use</span>
                                <span class="word" onclick="toggleWord(this)">to</span>
                                <span class="word" onclick="toggleWord(this)">spin</span>
                                <span class="word" onclick="toggleWord(this)">this</span>?
                            </div>
                        </div>

                        <div class="dialogue-item woman">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë©</span>
                                <span>Â•≥Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;Not really. He didn&#39;t act like a benevolent priest; he acted like a tyrant. Even the quotation from his speech regarding family values sounds somewhat ironic now.&#39;, &#39;woman&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">Not</span>
                                <span class="word" onclick="toggleWord(this)">really</span>.
                                <span class="word" onclick="toggleWord(this)">He</span>
                                <span class="word" onclick="toggleWord(this)">didn't</span>
                                <span class="word" onclick="toggleWord(this)">act</span>
                                <span class="word" onclick="toggleWord(this)">like</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">benevolent</span>
                                <span class="word" onclick="toggleWord(this)">priest</span>;
                                <span class="word" onclick="toggleWord(this)">he</span>
                                <span class="word" onclick="toggleWord(this)">acted</span>
                                <span class="word" onclick="toggleWord(this)">like</span>
                                <span class="word" onclick="toggleWord(this)">a</span>
                                <span class="word" onclick="toggleWord(this)">tyrant</span>.
                                <span class="word" onclick="toggleWord(this)">Even</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">quotation</span>
                                <span class="word" onclick="toggleWord(this)">from</span>
                                <span class="word" onclick="toggleWord(this)">his</span>
                                <span class="word" onclick="toggleWord(this)">speech</span>
                                <span class="word" onclick="toggleWord(this)">regarding</span>
                                <span class="word" onclick="toggleWord(this)">family</span>
                                <span class="word" onclick="toggleWord(this)">values</span>
                                <span class="word" onclick="toggleWord(this)">sounds</span>
                                <span class="word" onclick="toggleWord(this)">somewhat</span>
                                <span class="word" onclick="toggleWord(this)">ironic</span>
                                <span class="word" onclick="toggleWord(this)">now</span>.
                            </div>
                        </div>

                        <div class="dialogue-item man">
                            <div class="speaker-info">
                                <span class="speaker-avatar">üë®</span>
                                <span>Áî∑Â£´</span>
                                <button class="play-line-button" onclick="playLine(&#39;Fine. Pay them. I&#39;ll go handle the candidate.&#39;, &#39;man&#39;)">üîä</button>
                            </div>
                            <div class="dialogue-text">
                                <span class="word" onclick="toggleWord(this)">Fine</span>.
                                <span class="word" onclick="toggleWord(this)">Pay</span>
                                <span class="word" onclick="toggleWord(this)">them</span>.
                                <span class="word" onclick="toggleWord(this)">I'll</span>
                                <span class="word" onclick="toggleWord(this)">go</span>
                                <span class="word" onclick="toggleWord(this)">handle</span>
                                <span class="word" onclick="toggleWord(this)">the</span>
                                <span class="word" onclick="toggleWord(this)">candidate</span>.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="questions-section">
                    <button class="questions-toggle" onclick="toggleQuestionTitles()">
                        <span id="questionTitlesToggleText">üëÅÔ∏è ÈöêËóèÈ¢òÁõÆ</span>
                    </button>

                    <h3 class="section-title">È¢òÁõÆ üìù</h3>

                    <div class="questions-content" id="questionsContent">
                        <!-- È¢òÁõÆÂÜÖÂÆπ‰øùÊåÅ‰∏çÂèò -->
                        <div class="question-item">
                            <div class="question-number">Q1</div>
                            <div class="question-text">What is the main problem the speakers are discussing?</div>

                            <div class="option-item" onclick="selectOption(this, 1, &#39;A&#39;)">
                                <div class="option-letter">A</div>
                                <div class="option-text">The candidate's health issues regarding his lungs.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 1, &#39;B&#39;)">
                                <div class="option-letter">B</div>
                                <div class="option-text">A financial dispute with the campaign attorney.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 1, &#39;C&#39;)">
                                <div class="option-letter">C</div>
                                <div class="option-text">The candidate's inappropriate behavior and the resulting staff crisis.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 1, &#39;D&#39;)">
                                <div class="option-letter">D</div>
                                <div class="option-text">A political trick played by the opposition party.</div>
                            </div>

                            <div class="answer-explanation" id="explanation1" style="display: none;">
                                <div class="explanation-header">
                                    <h4>Á≠îÊ°àËß£Êûê</h4>
                                    <div class="correct-answer">Ê≠£Á°ÆÁ≠îÊ°à: C</div>
                                </div>
                                <div class="explanation-text">
                                    The dialogue revolves around the candidate ("Mr. Henderson") having a "meltdown," throwing "furniture" and "underwear," and the staff threatening to "strike." While health and finance are mentioned, they are secondary to the behavioral crisis.
                                </div>
                            </div>
                        </div>

                        <div class="question-item">
                            <div class="question-number">Q2</div>
                            <div class="question-text">According to the woman, how did the candidate react to the chef?</div>

                            <div class="option-item" onclick="selectOption(this, 2, &#39;A&#39;)">
                                <div class="option-letter">A</div>
                                <div class="option-text">He fired the chef for being a spy.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 2, &#39;B&#39;)">
                                <div class="option-letter">B</div>
                                <div class="option-text">He physically dragged the chef downstairs.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 2, &#39;C&#39;)">
                                <div class="option-letter">C</div>
                                <div class="option-text">He remained civil but refused to eat the soup.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 2, &#39;D&#39;)">
                                <div class="option-letter">D</div>
                                <div class="option-text">He became aggressive and threw personal items.</div>
                            </div>

                            <div class="answer-explanation" id="explanation2" style="display: none;">
                                <div class="explanation-header">
                                    <h4>Á≠îÊ°àËß£Êûê</h4>
                                    <div class="correct-answer">Ê≠£Á°ÆÁ≠îÊ°à: D</div>
                                </div>
                                <div class="explanation-text">
                                    The woman states, "He threw a wet towel, and even his underwear, at the poor servant." This matches the option of becoming aggressive and throwing personal items.
                                </div>
                            </div>
                        </div>

                        <div class="question-item">
                            <div class="question-number">Q3</div>
                            <div class="question-text">What does the man imply is the priority in handling the situation?</div>

                            <div class="option-item" onclick="selectOption(this, 3, &#39;A&#39;)">
                                <div class="option-letter">A</div>
                                <div class="option-text">Ensuring the candidate receives medical attention for his organs.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 3, &#39;B&#39;)">
                                <div class="option-letter">B</div>
                                <div class="option-text">Preventing the incident from becoming public to protect the campaign.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 3, &#39;C&#39;)">
                                <div class="option-letter">C</div>
                                <div class="option-text">Convincing the Congress panel to intervene in the strike.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 3, &#39;D&#39;)">
                                <div class="option-letter">D</div>
                                <div class="option-text">Teaching the candidate how to behave like a civil servant.</div>
                            </div>

                            <div class="answer-explanation" id="explanation3" style="display: none;">
                                <div class="explanation-header">
                                    <h4>Á≠îÊ°àËß£Êûê</h4>
                                    <div class="correct-answer">Ê≠£Á°ÆÁ≠îÊ°à: B</div>
                                </div>
                                <div class="explanation-text">
                                    The man mentions that if "external news reaches the Congress... our capital in this contest will vanish." He later states their "objective is to win" and agrees to pay to "retain control," implying the priority is containing the damage to the campaign.
                                </div>
                            </div>
                        </div>

                        <div class="question-item">
                            <div class="question-number">Q4</div>
                            <div class="question-text">What solution do the speakers agree upon regarding the staff?</div>

                            <div class="option-item" onclick="selectOption(this, 4, &#39;A&#39;)">
                                <div class="option-letter">A</div>
                                <div class="option-text">They will replace the domestic staff immediately.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 4, &#39;B&#39;)">
                                <div class="option-letter">B</div>
                                <div class="option-text">They will meet the financial and emotional demands of the staff.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 4, &#39;C&#39;)">
                                <div class="option-letter">C</div>
                                <div class="option-text">They will ask the priest to mediate the conflict.</div>
                            </div>

                            <div class="option-item" onclick="selectOption(this, 4, &#39;D&#39;)">
                                <div class="option-letter">D</div>
                                <div class="option-text">They will challenge the attorney's quotation in court.</div>
                            </div>

                            <div class="answer-explanation" id="explanation4" style="display: none;">
                                <div class="explanation-header">
                                    <h4>Á≠îÊ°àËß£Êûê</h4>
                                    <div class="correct-answer">Ê≠£Á°ÆÁ≠îÊ°à: B</div>
                                </div>
                                <div class="explanation-text">
                                    The woman mentions the staff demands a "higher wage" and a "sincere apology." The man concludes by saying, "We have to grant it... Pay them." This confirms they agree to meet the demands.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="submit-section" id="submitSection">
                <div class="progress-text">Â∑≤ÂÆåÊàê <span id="answeredCount">0</span> / 4 È¢ò</div>
                <button class="submit-button" id="submitButton" onclick="submitAnswers()" disabled="">Êèê‰∫§Á≠îÊ°à</button>
            </div>

            <div class="results-section" id="resultsSection" style="display: none;">
                <div class="score-display">
                    <span class="score-text">ÂæóÂàÜ: <span id="correctCount">0</span> / 4 (<span id="percentage">0</span>%)</span>
                    <span class="score-grade" id="scoreGrade">‚ùå Êú™ÈÄöËøá</span>
                </div>
                <button class="reset-button" onclick="resetQuiz()">ÈáçÊñ∞ÁªÉ‰π†</button>
            </div>
        </div>
    </div>

    <script>
        let selectedAnswers = {};
        let correctAnswers = {1: 'C', 2: 'D', 3: 'B', 4: 'B'};
        let currentUtterance = null;
        let dialogueVisible = false; // ÈªòËÆ§‰∏∫‰∏çÊòæÁ§∫ÂØπËØùÂÜÖÂÆπ
        let questionTitlesVisible = false; // ÈªòËÆ§‰∏∫‰∏çÊòæÁ§∫È¢òÁõÆÊ†áÈ¢ò
        let voices = [];
        let femaleVoices = [];
        let maleVoices = [];
        let progressInterval = null;
        let startTime = null;
        let estimatedDuration = 60000; // ‰º∞ËÆ°60Áßí
        let isPlaying = false;
        let currentDialogueIndex = 0;

        // ÂØπËØùÊï∞ÊçÆÔºåÂåÖÂê´ÊÄßÂà´‰ø°ÊÅØ
        const dialogueData = [
            { text: "Mark, we have a disaster downstairs. The domestic staff is threatening to go on strike. Our candidate, Mr. Henderson, just had a meltdown.", gender: "woman" },
            { text: "Again? I saw trash and broken furniture in the hallway. Did he really drag the heavy oak table across the room?", gender: "man" },
            { text: "Yes. He claimed the chef put a political trick in his soup. He threw a wet towel, and even his underwear, at the poor servant. It was incredibly offensive. He shouted that he is the lord of this manor, not a plain citizen.", gender: "woman" },
            { text: "That violates every criterion of civil behavior. If this external news reaches the Congress or the ethics panel, our capital in this contest will vanish. We can't pretend this is normal.", gender: "man" },
            { text: "I tried to whisper a warning to him, but he wouldn't lean in to listen. He has this notion that he can do whatever he wants. Honestly, he looks hollow. He's smoking pack after pack of cigarettes; I'm worried about his lung capacity and organ failure.", gender: "woman" },
            { text: "We need insight into his mental state. Is he fit for the obligation of being mayor? Regardless, we must retain control. What is the amount needed to settle this?", gender: "man" },
            { text: "The attorney sent a quotation. The staff demands a higher wage and a sincere apology, or they walk. It is a hefty sum.", gender: "woman" },
            { text: "We have to grant it. Our objective is to win. We can't let the motor of this campaign stall now. Is there any stuff we can use to spin this?", gender: "man" },
            { text: "Not really. He didn't act like a benevolent priest; he acted like a tyrant. Even the quotation from his speech regarding family values sounds somewhat ironic now.", gender: "woman" },
            { text: "Fine. Pay them. I'll go handle the candidate.", gender: "man" }
        ];

        // Âº∫Âà∂ÂàùÂßãÂåñËØ≠Èü≥
        function forceInitializeVoices() {
            console.log('Force initializing voices...');

            // ÂèñÊ∂àÊâÄÊúâÂΩìÂâçËØ≠Èü≥
            speechSynthesis.cancel();

            // Ëé∑ÂèñËØ≠Èü≥ÂàóË°®
            voices = speechSynthesis.getVoices();
            console.log('Total voices available:', voices.length);

            // Ê∏ÖÁ©∫ÂàÜÁ±ª
            femaleVoices = [];
            maleVoices = [];

            // ÈáçÊñ∞ÂàÜÁ±ªËØ≠Èü≥
            voices.forEach((voice, index) => {
                const name = voice.name.toLowerCase();
                const lang = voice.lang.toLowerCase();

                console.log(`Voice ${index}: ${name} (${lang})`);

                // ‰ΩøÁî®Ê≠£Á°ÆÁöÑÂ•≥Â£∞ÂàóË°®
                const femaleNames = [
                    'microsoft aysha online (natural)',
                    'microsoft amany online (natural)',
                    'microsoft xiaobei online (natural)',
                    'microsoft hsiaoyu online (natural)',
                    'microsoft xiaoni online (natural)',
                    'microsoft christel online (natural)',
                    'microsoft clara online (natural)',
                    'microsoft neerja online (natural)',
                    'microsoft asilia online (natural)',
                    'microsoft molly online (natural)',
                    'microsoft abeo online (natural)',
                    'microsoft rosa online (natural)',
                    'microsoft emma online (natural)',
                    'microsoft luna online (natural)',
                    'microsoft imani online (natural)',
                    'microsoft libby online (natural)',
                    'microsoft maisie online (natural)',
                    'microsoft sonia online (natural)',
                    'microsoft aria online (natural)',
                    'microsoft michelle online (natural)',
                    'microsoft ingrid online (natural)',
                    'microsoft seraphinamultilingual online (natural)',
                    'microsoft amala online (natural)',
                    'microsoft katja online (natural)',
                    'microsoft leni online (natural)',
                    'microsoft keomany online (natural)',
                    'microsoft alina online (natural)',
                    'microsoft natasha online (natural)',
                    'microsoft yan online (natural)',
                    'microsoft emily online (natural)',
                    'microsoft mitchell online (natural)',
                    'microsoft ezinne online (natural)',
                    'microsoft ava online (natural)',
                    'microsoft leah online (natural)',
                    'microsoft ryan online (natural)',
                    'microsoft ana online (natural)',
                    'microsoft avamultilingual online (natural)',
                    'microsoft emmamultilingual online (natural)',
                    'microsoft jenny online (natural)',
                    'microsoft steffan online (natural)',
                    'microsoft sofia online (natural)',
                    'microsoft marcelo online (natural)',
                    'microsoft nathan online (natural)',
                    'microsoft sophia online (natural)',
                    'microsoft elena online (natural)',
                    'microsoft michael online (natural)'
                ];

                // ‰ΩøÁî®Ê≠£Á°ÆÁöÑÁî∑Â£∞ÂàóË°®
                const maleNames = [
                    'microsoft iman online (natural)',
                    'microsoft abdullah online (natural)',
                    'microsoft jeppe online (natural)',
                    'microsoft williammultilingual online (natural)',
                    'microsoft liam online (natural)',
                    'microsoft sam online (natural)',
                    'microsoft prabhat online (natural)',
                    'microsoft connor online (natural)',
                    'microsoft chilemba online (natural)',
                    'microsoft james online (natural)',
                    'microsoft andrew online (natural)',
                    'microsoft wayne online (natural)',
                    'microsoft luke online (natural)',
                    'microsoft elimu online (natural)',
                    'microsoft thomas online (natural)',
                    'microsoft andrewmultilingual online (natural)',
                    'microsoft brianmultilingual online (natural)',
                    'microsoft christopher online (natural)',
                    'microsoft eric online (natural)',
                    'microsoft guy online (natural)',
                    'microsoft roger online (natural)',
                    'microsoft jonas online (natural)',
                    'microsoft florianmultilingual online (natural)',
                    'microsoft conrad online (natural)',
                    'microsoft killian online (natural)',
                    'microsoft jan online (natural)',
                    'microsoft osman online (natural)',
                    'microsoft manohar online (natural)',
                    'microsoft emil online (natural)',
                    'microsoft manuel online (natural)',
                    'microsoft salman online (natural)',
                    'microsoft brian online (natural)',
                    'microsoft william online (natural)',
                    'microsoft archie online (natural)',
                    'microsoft will online (natural)',
                    'microsoft colin online (natural)',
                    'microsoft aoi online (natural)',
                    'microsoft mole online (natural)'
                ];

                // Ê£ÄÊü•ÊòØÂê¶‰∏∫Â•≥Â£∞
                const isFemale = femaleNames.some(femaleName => name.includes(femaleName));
                const isMale = maleNames.some(maleName => name.includes(maleName));

                if (isFemale) {
                    femaleVoices.push({voice: voice, index: index, type: 'female'});
                    console.log(`  -> Classified as female: ${name}`);
                } else if (isMale) {
                    maleVoices.push({voice: voice, index: index, type: 'male'});
                    console.log(`  -> Classified as male: ${name}`);
                }
            });

            console.log(`Final classification: ${femaleVoices.length} female, ${maleVoices.length} male`);

            populateVoiceSelects();
            updateDebugInfo();

            return true;
        }

        // Â°´ÂÖÖËØ≠Èü≥ÈÄâÊã©Ê°Ü
        function populateVoiceSelects() {
            const femaleSelect = document.getElementById('femaleVoiceSelect');
            const maleSelect = document.getElementById('maleVoiceSelect');

            if (!femaleSelect || !maleSelect) {
                console.error('Voice select elements not found');
                return;
            }

            // Ê∏ÖÁ©∫Áé∞ÊúâÈÄâÈ°π
            femaleSelect.innerHTML = '';
            maleSelect.innerHTML = '';

            // Ëá™Âä®ÈÄâÊã©ÈÄâÈ°π
            const autoOption = document.createElement('option');
            autoOption.value = 'auto';
            autoOption.textContent = 'Ëá™Âä®ÈÄâÊã©';
            const femaleAutoOption = autoOption.cloneNode(true);
            const maleAutoOption = autoOption.cloneNode(true);
            femaleSelect.appendChild(femaleAutoOption);
            maleSelect.appendChild(maleAutoOption);

            // Ê∑ªÂä†Â•≥Â£∞ÈÄâÈ°π
            if (femaleVoices.length > 0) {
                const femaleGroup = document.createElement('optgroup');
                femaleGroup.label = 'Â•≥Â£∞';
                femaleVoices.forEach(item => {
                    const option = document.createElement('option');
                    option.value = `female-${item.index}`;
                    option.textContent = `${item.voice.name} (${item.voice.lang})`;
                    femaleGroup.appendChild(option);
                });
                femaleSelect.appendChild(femaleGroup);
            }

            // Ê∑ªÂä†Áî∑Â£∞ÈÄâÈ°π
            if (maleVoices.length > 0) {
                const maleGroup = document.createElement('optgroup');
                maleGroup.label = 'Áî∑Â£∞';
                maleVoices.forEach(item => {
                    const option = document.createElement('option');
                    option.value = `male-${item.index}`;
                    option.textContent = `${item.voice.name} (${item.voice.lang})`;
                    maleGroup.appendChild(option);
                });
                maleSelect.appendChild(maleGroup);
            }

            console.log('Voice select boxes populated successfully');
        }

        // Êõ¥Êñ∞Ë∞ÉËØï‰ø°ÊÅØ
        function updateDebugInfo() {
            const debugInfo = document.getElementById('debugInfo');
            const debugDiv = document.getElementById('voiceDebug');

            if (!debugInfo || !debugDiv) return;

            const femaleSelection = document.getElementById('femaleVoiceSelect').value;
            const maleSelection = document.getElementById('maleVoiceSelect').value;

            debugInfo.innerHTML = `
                ÊÄªËØ≠Èü≥Êï∞Èáè: ${voices.length}<br>
                ÂèØÁî®Â•≥Â£∞: ${femaleVoices.length}<br>
                ÂèØÁî®Áî∑Â£∞: ${maleVoices.length}<br>
                ÂΩìÂâçÂ•≥Â£∞ÈÄâÊã©: ${femaleSelection}<br>
                ÂΩìÂâçÁî∑Â£∞ÈÄâÊã©: ${maleSelection}<br>
                ÊµèËßàÂô®: ${navigator.userAgent}<br>
                ËØ≠Ë®ÄÊîØÊåÅ: ${speechSynthesis.getVoices().length} ËØ≠Èü≥
            `;

            debugDiv.style.display = 'block';
        }

        // ÈÄâÊã©ÂêàÈÄÇÁöÑËØ≠Èü≥ - Â¢ûÂº∫ÁâàÊú¨
        function selectVoice(gender) {
            console.log(`Selecting voice for gender: ${gender}`);

            const voiceSelect = gender === 'woman' ?
                document.getElementById('femaleVoiceSelect') :
                document.getElementById('maleVoiceSelect');

            if (!voiceSelect) {
                console.error(`Voice select element for ${gender} not found`);
                return null;
            }

            const voiceSelectValue = voiceSelect.value;
            console.log(`Voice select value: ${voiceSelectValue}`);

            let selectedVoice = null;
            let selectedIndex = -1;

            // Â¶ÇÊûúÁî®Êà∑ÊâãÂä®ÈÄâÊã©‰∫ÜËØ≠Èü≥
            if (voiceSelectValue !== 'auto') {
                const [voiceType, voiceIndex] = voiceSelectValue.split('-');
                const index = parseInt(voiceIndex);

                if (voices[index]) {
                    selectedVoice = voices[index];
                    selectedIndex = index;
                    console.log(`Manual voice selected for ${gender}:`, selectedVoice.name);
                } else {
                    console.warn(`Invalid voice index: ${index}`);
                }
            }

            // Ëá™Âä®ÈÄâÊã© - ‰ºòÂÖàÈÄâÊã© en-US ÁöÑËØ≠Èü≥
            if (!selectedVoice) {
                const targetVoices = gender === 'woman' ? femaleVoices : maleVoices;

                if (targetVoices.length > 0) {
                    // È¶ñÂÖàÂ∞ùËØïÈÄâÊã© en-US ÁöÑËØ≠Èü≥
                    const enUSVoice = targetVoices.find(item =>
                        item.voice.lang.toLowerCase().includes('en-us')
                    );

                    if (enUSVoice) {
                        selectedVoice = enUSVoice.voice;
                        selectedIndex = enUSVoice.index;
                        console.log(`Auto selected en-US ${gender} voice:`, selectedVoice.name);
                    } else {
                        // Â¶ÇÊûúÊ≤°Êúâ en-USÔºåÈÄâÊã©Á¨¨‰∏Ä‰∏™ÂèØÁî®ËØ≠Èü≥
                        selectedVoice = targetVoices[0].voice;
                        selectedIndex = targetVoices[0].index;
                        console.log(`Auto selected first available ${gender} voice:`, selectedVoice.name);
                    }

                    // Ëá™Âä®Êõ¥Êñ∞‰∏ãÊãâÂàóË°®ÁöÑÈÄâÊã©
                    if (selectedIndex >= 0) {
                        voiceSelect.value = `${gender === 'woman' ? 'female' : 'male'}-${selectedIndex}`;
                        console.log(`Updated voice select to: ${voiceSelect.value}`);
                    }
                } else {
                    console.warn(`No ${gender} voices available`);
                }
            }

            // ÂõûÈÄÄÂà∞ÈªòËÆ§ËØ≠Èü≥
            if (!selectedVoice) {
                const englishVoices = voices.filter(v => v.lang.includes('en'));
                selectedVoice = englishVoices.length > 0 ? englishVoices[0] : voices[0];
                console.log(`Fallback voice selected:`, selectedVoice ? selectedVoice.name : 'None');
            }

            return selectedVoice;
        }

        // ÂàõÂª∫ÂØπËØùËØ≠Èü≥ÂêàÊàê - Â¢ûÂº∫ÁâàÊú¨
        function createDialogueUtterance(text, gender) {
            console.log(`Creating utterance for ${gender}:`, text.substring(0, 30) + '...');

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = parseFloat(document.getElementById('speedSelect').value);

            // ‰ΩøÁî®ÂØπÂ∫îÊÄßÂà´ÁöÑËØ≠Èü≥
            const selectedVoice = selectVoice(gender);
            if (selectedVoice) {
                utterance.voice = selectedVoice;
                console.log(`Using ${gender} voice:`, selectedVoice.name);
            } else {
                console.warn(`No voice available for ${gender}, using default`);
            }

            // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®Áî®‰∫éË∞ÉËØï
            utterance.onstart = () => {
                console.log(`Started speaking (${gender}):`, text.substring(0, 20) + '...');
            };

            utterance.onend = () => {
                console.log(`Finished speaking (${gender}):`, text.substring(0, 20) + '...');
            };

            utterance.onerror = (event) => {
                console.error(`Error speaking (${gender}):`, event);
            };

            return utterance;
        }

        // ÊµãËØïÂ•≥Â£∞
        function testFemaleVoice() {
            stopDialogue();
            const testText = "This is a test of the female voice selection.";
            const utterance = createDialogueUtterance(testText, 'woman');
            speechSynthesis.speak(utterance);
        }

        // ÊµãËØïÁî∑Â£∞
        function testMaleVoice() {
            stopDialogue();
            const testText = "This is a test of the male voice selection.";
            const utterance = createDialogueUtterance(testText, 'man');
            speechSynthesis.speak(utterance);
        }

        // Êí≠ÊîæÂÆåÊï¥ÂØπËØù - ‰ΩøÁî®Â§öÁßçËØ≠Èü≥‰∫§ÊõøÊí≠Êîæ
        function playDialogue() {
            stopDialogue();

            console.log('Starting dialogue playback...');
            currentDialogueIndex = 0;
            isPlaying = true;

            function playNextLine() {
                // Ê£ÄÊü•ÊòØÂê¶Ë¢´ÂÅúÊ≠¢
                if (!isPlaying || currentDialogueIndex >= dialogueData.length) {
                    // Êí≠ÊîæÂÆåÊàêÊàñË¢´ÂÅúÊ≠¢
                    stopProgress();
                    document.getElementById('playButton').style.display = 'inline-block';
                    document.getElementById('stopButton').style.display = 'none';
                    isPlaying = false;

                    if (currentDialogueIndex >= dialogueData.length) {
                        console.log('Dialogue playback completed');
                    } else {
                        console.log('Dialogue playback stopped');
                    }
                    return;
                }

                const dialogue = dialogueData[currentDialogueIndex];
                console.log(`Playing line ${currentDialogueIndex + 1}/${dialogueData.length} (${dialogue.gender})`);

                const utterance = createDialogueUtterance(dialogue.text, dialogue.gender);

                utterance.onend = function() {
                    currentDialogueIndex++;
                    // Ê∑ªÂä†Áü≠ÊöÇÂª∂ËøüÔºå‰ΩøÂØπËØùÊõ¥Ëá™ÁÑ∂
                    if (isPlaying) {
                        setTimeout(playNextLine, 300);
                    }
                };

                utterance.onerror = function(event) {
                    console.error('Error playing dialogue line:', event);
                    currentDialogueIndex++;
                    if (isPlaying) {
                        setTimeout(playNextLine, 300);
                    }
                };

                speechSynthesis.speak(utterance);
            }

            // ÂºÄÂßãÊí≠Êîæ
            document.getElementById('playButton').style.display = 'none';
            document.getElementById('stopButton').style.display = 'inline-block';
            startProgress();
            playNextLine();
        }

        // ÂÅúÊ≠¢Êí≠Êîæ
        function stopDialogue() {
            if (currentUtterance || speechSynthesis.speaking) {
                isPlaying = false;  // ËÆæÁΩÆÂÅúÊ≠¢Ê†áÂøó
                speechSynthesis.cancel();
                currentUtterance = null;
                document.getElementById('playButton').style.display = 'inline-block';
                document.getElementById('stopButton').style.display = 'none';
                stopProgress();
                console.log('Dialogue playback stopped');
            }
        }

        // Êí≠ÊîæÂçïË°å
        function playLine(text, gender) {
            // ÂÅúÊ≠¢ÂØπËØùÊí≠Êîæ‰ΩÜÁªßÁª≠Êí≠ÊîæÂçïË°å
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
                stopProgress();
            }
            console.log(`Playing single line (${gender}):`, text.substring(0, 30) + '...');

            const utterance = createDialogueUtterance(text, gender);
            speechSynthesis.speak(utterance);
        }

        // ÂºÄÂßãËøõÂ∫¶ÊåáÁ§∫
        function startProgress() {
            startTime = Date.now();
            progressInterval = setInterval(() => {
                if (speechSynthesis.speaking) {
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min((elapsed / estimatedDuration) * 100, 100);

                    document.getElementById('progressFill').style.width = progress + '%';
                    document.getElementById('progressIndicator').style.width = progress + '%';

                    // Êõ¥Êñ∞Êó∂Èó¥ÊòæÁ§∫
                    const currentSeconds = Math.floor(elapsed / 1000);
                    const totalSeconds = Math.floor(estimatedDuration / 1000);
                    document.getElementById('currentTime').textContent = formatTime(currentSeconds);
                    document.getElementById('totalTime').textContent = formatTime(totalSeconds);
                }
            }, 100);
        }

        // ÂÅúÊ≠¢ËøõÂ∫¶ÊåáÁ§∫
        function stopProgress() {
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }

            // ÈáçÁΩÆËøõÂ∫¶Êù°
            setTimeout(() => {
                document.getElementById('progressFill').style.width = '0%';
                document.getElementById('progressIndicator').style.width = '0%';
                document.getElementById('currentTime').textContent = '0:00';
                document.getElementById('totalTime').textContent = '0:00';
            }, 1000);
        }

        // Ê†ºÂºèÂåñÊó∂Èó¥
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${minutes}:${secs.toString().padStart(2, '0')}`;
        }

        // ÂàáÊç¢ÂØπËØùÊòæÁ§∫/ÈöêËóè
        function toggleDialogue() {
            const dialogueContent = document.getElementById('dialogueContent');
            const toggleText = document.getElementById('dialogueToggleText');

            dialogueVisible = !dialogueVisible;

            if (dialogueVisible) {
                dialogueContent.style.display = 'block';
                toggleText.textContent = 'üëÅÔ∏è ÈöêËóèÂØπËØùÂÜÖÂÆπ';
            } else {
                dialogueContent.style.display = 'none';
                toggleText.textContent = 'üëÅÔ∏è ÊòæÁ§∫ÂØπËØùÂÜÖÂÆπ';
            }
        }

        // ÂàáÊç¢È¢òÁõÆÊ†áÈ¢òÊòæÁ§∫/ÈöêËóè
        function toggleQuestionTitles() {
            const questionTitles = document.querySelectorAll('.question-text');
            const toggleText = document.getElementById('questionTitlesToggleText');
            const questionsTitlesVisible = toggleText.textContent.includes('ÈöêËóè');

            questionTitles.forEach(title => {
                if (questionsTitlesVisible) {
                    title.style.display = 'none';
                } else {
                    title.style.display = 'block';
                }
            });

            if (questionsTitlesVisible) {
                toggleText.textContent = 'üëÅÔ∏è ÊòæÁ§∫È¢òÁõÆ';
            } else {
                toggleText.textContent = 'üëÅÔ∏è ÈöêËóèÈ¢òÁõÆ';
            }
        }

        // ÈÄâÊã©Á≠îÊ°àÈÄâÈ°π
        function selectOption(element, questionNumber, option) {
            const questionContainer = element.closest('.question-item');
            const options = questionContainer.querySelectorAll('.option-item');
            options.forEach(opt => opt.classList.remove('selected'));

            element.classList.add('selected');
            selectedAnswers[questionNumber] = option;
            updateProgress();
        }

        // Êõ¥Êñ∞ËøõÂ∫¶
        function updateProgress() {
            const answeredCount = Object.keys(selectedAnswers).length;
            document.getElementById('answeredCount').textContent = answeredCount;

            const submitButton = document.getElementById('submitButton');
            submitButton.disabled = answeredCount !== 4;
        }

        // Êèê‰∫§Á≠îÊ°à
        function submitAnswers() {
            let correctCount = 0;

            for (let questionNumber in selectedAnswers) {
                if (selectedAnswers[questionNumber] === correctAnswers[questionNumber]) {
                    correctCount++;
                }

                document.getElementById('explanation' + questionNumber).style.display = 'block';

                const questionContainer = document.querySelector(`#explanation${questionNumber}`).closest('.question-item');
                const options = questionContainer.querySelectorAll('.option-item');
                options.forEach(opt => {
                    const optionLetter = opt.querySelector('.option-letter').textContent;
                    if (optionLetter === correctAnswers[questionNumber]) {
                        opt.classList.add('correct');
                    } else if (opt.classList.contains('selected') && optionLetter !== correctAnswers[questionNumber]) {
                        opt.classList.add('wrong');
                    }
                });
            }

            const percentage = Math.round((correctCount / 4) * 100);
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('percentage').textContent = percentage;

            const scoreGrade = document.getElementById('scoreGrade');
            if (percentage >= 60) {
                scoreGrade.textContent = '‚úÖ ÈÄöËøá';
                scoreGrade.className = 'score-grade pass';
            } else {
                scoreGrade.textContent = '‚ùå Êú™ÈÄöËøá';
                scoreGrade.className = 'score-grade fail';
            }

            document.getElementById('submitSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
        }

        // ÈáçÁΩÆÁªÉ‰π†
        function resetQuiz() {
            selectedAnswers = {};

            document.querySelectorAll('.option-item').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'wrong');
            });

            document.querySelectorAll('.answer-explanation').forEach(exp => {
                exp.style.display = 'none';
            });

            updateProgress();
            document.getElementById('submitSection').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
        }

        // ÂàáÊç¢ÂçïËØçÊéåÊè°Áä∂ÊÄÅ
        function toggleWord(element) {
            element.classList.toggle('mastered');
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ - Â¢ûÂº∫ÁâàÊú¨
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM content loaded');

            // Â§öÊ¨°Â∞ùËØïÂàùÂßãÂåñËØ≠Èü≥
            let attempts = 0;
            const maxAttempts = 5;

            function tryInitialize() {
                attempts++;
                console.log(`Voice initialization attempt ${attempts}/${maxAttempts}`);

                if (forceInitializeVoices()) {
                    console.log('Voice initialization successful');
                } else if (attempts < maxAttempts) {
                    console.log('Retrying voice initialization...');
                    setTimeout(tryInitialize, 500);
                } else {
                    console.error('Failed to initialize voices after multiple attempts');
                    // Âç≥‰ΩøÂ§±Ë¥•‰πüË¶ÅÊòæÁ§∫Ë∞ÉËØï‰ø°ÊÅØ
                    updateDebugInfo();
                }
            }

            // Á´ãÂç≥Â∞ùËØïÂàùÂßãÂåñ
            tryInitialize();

            // ‰πüÁõëÂê¨ËØ≠Èü≥ÂèòÂåñ‰∫ã‰ª∂
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = function() {
                    console.log('Voices changed, reinitializing...');
                    forceInitializeVoices();
                };
            }

            // Ê∑ªÂä†ËØ≠Èü≥ÈÄâÊã©‰∫ã‰ª∂ÁõëÂê¨
            setTimeout(() => {
                const femaleSelect = document.getElementById('femaleVoiceSelect');
                const maleSelect = document.getElementById('maleVoiceSelect');

                if (femaleSelect) {
                    femaleSelect.addEventListener('change', function() {
                        console.log('Female voice selection changed to:', this.value);
                        updateDebugInfo();
                    });
                }

                if (maleSelect) {
                    maleSelect.addEventListener('change', function() {
                        console.log('Male voice selection changed to:', this.value);
                        updateDebugInfo();
                    });
                }

                // Âª∂Ëøü‰∏ÄÊ¨°È¢ùÂ§ñÁöÑÂàùÂßãÂåñ
                setTimeout(() => {
                    forceInitializeVoices();

                    // ÈªòËÆ§ÈöêËóèÈ¢òÁõÆÊ†áÈ¢ò
                    const questionTitles = document.querySelectorAll('.question-text');
                    questionTitles.forEach(title => {
                        title.style.display = 'none';
                    });
                    document.getElementById('questionTitlesToggleText').textContent = 'üëÅÔ∏è ÊòæÁ§∫È¢òÁõÆ';
                }, 1000);
            }, 100);
        });

        // ‰πüÂú®È°µÈù¢Âä†ËΩΩÂêéÂ∞ùËØï‰∏ÄÊ¨°
        window.addEventListener('load', function() {
            console.log('Page fully loaded');
            setTimeout(() => {
                forceInitializeVoices();
            }, 500);
        });
    </script>

</body></html>